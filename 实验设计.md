# 实验设计与对比分析报告 (Experimental Design and Comparative Analysis)

## 1. 实验设置与参数 (Experimental Setup & Parameters)

本研究在受控的多任务环境构建了对比实验，旨在验证 CDSP 架构在没有任何人工先验拓扑约束下的自组织能力。

### 1.1 数据集构建：异质多任务环境 (Heterogeneous Multi-Task Environment)

我们构建了一个由三个经典数据集组成的混合任务流，模拟不同抽象层级的视觉任务：

* **Task 0 (MNIST)**: 手写数字识别（0-9）。代表**简单符号/稀疏特征**任务。
* **Task 1 (KMNIST)**: 日本古假名草书识别（10类）。代表**复杂符号/连笔特征**任务。
* **Task 2 (Fashion-MNIST)**: 服饰图像识别（10类）。代表**实物图像/密集纹理**任务。
* **输入规格**: 所有图像统一为 $1 \times 28 \times 28$ 灰度图，Patchify 后输入模型。

### 1.2 模型架构对比 (Model Configurations)

为了公平比较“结构演化”与“蛮力计算”的差异，我们设置了两个对照组：

#### **A. 实验组：CDSP-MoE (Ours)**

* **专家数量**: $N=8$（逻辑专家）。
* **物理基座**: 单个共享的超完备基座，隐藏层维度 $D_{hidden} = 256$。
* **拓扑机制**: 专家通过可学习的掩码矩阵 $\alpha \in \mathbb{R}^{8 \times 8}$ 动态调用基座子空间。
* **路由机制**: Top-2 Gating，训练时引入 $p=0.1$ 的 **Task Dropout**。
* **参数量**: $\approx 32k$ (主要集中在共享基座)。

#### **B. 基线组：Standard MoE (Baseline)**

* **专家数量**: $N=8$（独立专家）。
* **专家结构**: 每个专家拥有独立的权重矩阵。
* **参数控制 (Iso-Parameter)**: 为了保证公平性，我们将每个独立专家的维度设为 $d = 32$ ($32 \times 8 = 256$)，使总参数量与 CDSP 保持一致 ($\approx 32k$)。
* **路由机制**: 标准 Top-2 Gating，无冲突约束，依赖显式 Task ID。

### 1.3 训练超参数

* **优化器**: AdamW。
* **学习率**: 物理参数 $lr=5e-3$，拓扑参数 $\alpha$  使用 $10\times$ 学习率 ($5e-2$) 以加速结构演化。
* **损失函数**:
*   $\mathcal{L}_{total} = \mathcal{L}_{task} + \lambda_{conflict} \cdot \mathcal{L}_{conflict} + \lambda_{sparsity} \cdot \mathcal{L}_{L1}$
*   $\lambda_{conflict} = 10.0$(强冲突惩罚)。



---

## 2. 实验设计逻辑 (Experimental Logic & Philosophy)

本实验的核心目的不是为了证明 CDSP 在简单任务上的准确率（Accuracy）超越基线，而是为了验证**“冲突驱动的结构涌现”**。

### 2.1 逻辑一：演化税与结构红利 (Evolutionary Tax vs. Structural Dividend)

* **假设**: Baseline 由于没有结构约束，初期会利用所有参数“死记硬背”，收敛速度较快（Low Bias）。CDSP 由于需要解决内部梯度冲突，初期会经历“阵痛期”，收敛较慢。
* **验证点**: 观察前 5 个 Epoch 的 Loss 下降曲线。我们预期看到 CDSP 的 Acc 落后于 Baseline，但这被视为系统正在进行“内部裁员和分工”的证据，而非缺陷。

### 2.2 逻辑二：从“身份政治”到“内容唯物主义” (From Identity to Content)

* **痛点**: 传统 MoE 严重依赖 Task ID。如果输入 ID，Router 只是在查表，并未理解任务本质。
* **CDSP 策略**: 引入 **Task Dropout**。在训练时随机屏蔽 Task ID，迫使 Router 必须观察图像内容的统计特征（如笔画密度、纹理复杂度）来决定去向。
* **验证点**: **盲测 (Blind Inference)**。在推理阶段，强行移除所有 Task ID (Input `None` / Zero Vector)，观察模型是否依然能正确分工。

### 2.3 逻辑三：相似性自发聚类 (Spontaneous Clustering)

* **假设**: 如果物理基座是共享的，且冲突机制有效，那么：
* **相似任务**（如 MNIST 和 KMNIST 均为线条图）应产生协同梯度  共享专家。
* **异质任务**（如 FMNIST 为实物图）应产生冲突梯度  独占专家。


* **验证点**: 观察 Alpha 矩阵和路由热力图，确认是否出现了符合上述逻辑的聚类现象。

---

## 3. 核心分析指标 (Key Analysis Metrics)

我们将通过以下三个维度的数据分析来支撑上述逻辑：

### 3.1 拓扑热力图分析 (Topology Heatmap Analysis)

这是证明“结构涌现”的最关键证据。

* **可视化对象**: 路由分配矩阵 (Tasks  Experts)。
* **对比场景**:
1. **Baseline**: 预期呈现混乱分布（所有任务均匀撒在所有专家上）或模式坍塌（所有任务涌向 Expert 0）。
2. **CDSP (Blind Test)**: 当输入 Task ID 为 `None` 时。
* 若 Task 0 (MNIST) 和 Task 1 (KMNIST) 激活了相同的专家集合，证明模型发现了**语义相似性**。
* 若 Task 2 (FMNIST) 激活了不同的专家，证明模型发现了**特征冲突**并进行了物理隔离。





### 3.2 鲁棒性与解耦测试 (Robustness & Disentanglement)

测试当外部指令缺失时，系统的生存能力。

* **操作**: 向模型输入 Task 1 (KMNIST) 的图片，但强行赋予 Task 0 (MNIST) 的 ID，或者不给 ID。
* **指标**:
* **Route Consistency**: 真实 Task 1 的数据是否依然流向 Task 1 的专家？（如果是，说明是**内容驱动**）。
* **Baseline Failure**: Baseline 在此情况下是否会将数据错误地分发给 Task 0 的专家？（如果是，说明是**ID 驱动**）。



### 3.3 专家特化度 (Expert Specialization Score)

量化专家的“纯度”。

* 计算每个专家处理的任务分布熵。
* **预期**: CDSP 的专家熵较低（每个专家只干一类活），Baseline 的专家熵较高（每个专家什么都干一点）。

---

## 4. 预期结论 (Expected Conclusion)

基于上述设计，我们预计实验将支持以下结论：

1. **Baseline** 是一个**“由 ID 驱动的黑盒”**，虽然收敛快，但结构脆弱，无法进行零样本路由。
2. **CDSP** 是一个**“由内容驱动的生态系统”**，虽然通过冲突机制支付了早期的计算代价，但演化出了**可解释的、语义对齐的**模块化结构。
3. 系统成功在没有任何人工语义标签（只有 Task ID 用于区分冲突，而非指导聚类）的情况下，**自发发现**了 KMNIST 与 MNIST 的相似性以及 FMNIST 的差异性。

## 5. 补充控制实验：纯盲训练基线 (Supplementary Control: Pure Blind Baseline)

为了进一步验证 CDSP 中的冲突机制（Conflict Mechanism）是实现语义特化（Semantic Specialization）的必要条件，而非仅仅源于数据本身的统计差异，我们引入了一个更为严格的控制组：**纯盲训练基线 (Pure Blind Baseline)**。

* **实验动机**: 标准 Baseline 依赖 Task ID 进行路由，这可能掩盖了模型本身对内容的理解能力。审稿人可能会质疑：即使没有冲突机制，仅仅依靠负载均衡损失（Aux Loss）和数据本身的特征差异，MoE 是否也能自发学会将异质任务分开？
* **设置**:
* **架构**: 与标准 Baseline 完全一致（同参数量、同结构）。
* **训练策略**: 类似于 DeepSeek/Mixtral 等现代 MoE 训练方式，我们在**训练全程**移除所有 Task ID 输入（Input `None`）。Router 仅能依赖图像内容（Patch Features）和负载均衡损失来进行专家选择。


* **预期对比**:
* **情况 A (CDSP 的胜利)**: 如果 Pure Blind Baseline 出现**模式坍塌 (Mode Collapse)** 或 **均匀混沌 (Uniform Chaos)**，即无法区分 MNIST 和 Fashion-MNIST，这将强有力地证明：仅靠 Aux Loss 无法驱动语义解耦，**冲突驱动机制是必要的**。
* **情况 B (CDSP 的挑战)**: 如果 Pure Blind Baseline 也能自发实现完美的语义聚类（如自动分开数字和衣服），则表明简单数据集的统计差异足够大，CDSP 的冲突机制可能在这个尺度上显得冗余。


* **分析重点**: 我们将重点对比 Pure Blind Baseline 与 CDSP 在盲测态下的热力图结构。我们假设 Baseline 将因缺乏冲突信号而陷入“为了均衡而均衡”的伪分工状态，无法形成像 CDSP 那样清晰的“符号 vs. 实物”语义边界。