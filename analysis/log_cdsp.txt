D:\AI\conda\envs\pytorch-transformer\python.exe D:\AI\test\CDSP-MoE\train_cdsp_mnist.py 
=== Training CDSP-MoE on cuda ===
Experiment: cdsp_mnist_3task
[Topology] Initialized Alpha: Diagonal=1.0, Off-diagonal~0.1
[Topology] Initialized Alpha: Diagonal=1.0, Off-diagonal~0.1
[SystemMonitor] Artifacts will be saved to: D:\AI\test\CDSP-MoE\analysis\pic\cdsp_mnist_3task
Epoch 1/10: 100%|██████████| 2813/2813 [04:16<00:00, 10.98it/s, Loss=0.9115, Aux=5.945e-04, Acc=56.25%, T0=45%, T1=55%, T2=70%]
Epoch 1 Summary: Loss=0.7434, Acc=71.14%
Epoch 2/10: 100%|██████████| 2813/2813 [04:13<00:00, 11.10it/s, Loss=0.4630, Aux=7.350e-04, Acc=90.62%, T0=77%, T1=100%, T2=100%]
Epoch 2 Summary: Loss=0.4517, Acc=81.85%
Epoch 3/10: 100%|██████████| 2813/2813 [04:16<00:00, 10.96it/s, Loss=0.3750, Aux=6.049e-04, Acc=84.38%, T0=100%, T1=62%, T2=86%]
Epoch 3 Summary: Loss=0.3272, Acc=86.94%
Epoch 4/10: 100%|██████████| 2813/2813 [04:20<00:00, 10.79it/s, Loss=0.0821, Aux=6.124e-04, Acc=96.88%, T0=100%, T1=92%, T2=100%]
Epoch 4 Summary: Loss=0.2516, Acc=90.17%
Epoch 5/10: 100%|██████████| 2813/2813 [04:23<00:00, 10.67it/s, Loss=0.0396, Aux=6.166e-04, Acc=100.00%, T0=100%, T1=100%, T2=100%]
Epoch 5 Summary: Loss=0.2143, Acc=91.80%
Epoch 6/10: 100%|██████████| 2813/2813 [04:29<00:00, 10.46it/s, Loss=0.1067, Aux=6.153e-04, Acc=93.75%, T0=100%, T1=90%, T2=89%]
Epoch 6 Summary: Loss=0.1911, Acc=92.81%
Epoch 7/10: 100%|██████████| 2813/2813 [04:20<00:00, 10.81it/s, Loss=0.1507, Aux=6.200e-04, Acc=96.88%, T0=92%, T1=100%, T2=100%]
Epoch 7 Summary: Loss=0.1780, Acc=93.32%
Epoch 8/10: 100%|██████████| 2813/2813 [04:21<00:00, 10.75it/s, Loss=0.0675, Aux=6.186e-04, Acc=96.88%, T0=91%, T1=100%, T2=100%]
Epoch 8 Summary: Loss=0.1657, Acc=93.77%
Epoch 9/10: 100%|██████████| 2813/2813 [04:35<00:00, 10.23it/s, Loss=0.2688, Aux=6.139e-04, Acc=93.75%, T0=100%, T1=100%, T2=78%]
Epoch 9 Summary: Loss=0.1571, Acc=94.15%
Epoch 10/10: 100%|██████████| 2813/2813 [04:13<00:00, 11.10it/s, Loss=0.1304, Aux=6.132e-04, Acc=93.75%, T0=92%, T1=92%, T2=100%]
Epoch 10 Summary: Loss=0.1512, Acc=94.42%
=== Training Finished. Generating Final Reports... ===

=== Running Deceptive Validation (Memory Model, Forcing Task ID = None) ===
Deceptive Testing: 100%|██████████| 300/300 [00:11<00:00, 26.65it/s]
Heatmap saved to deceptive_routing_forced_id_None.png

[SUCCESS] Content-based routing detected! Task 0 and Task 1 both chose Expert 5.
[Plotter] Loss curve saved to: D:\AI\test\CDSP-MoE\analysis\pic\cdsp_mnist_3task\loss_curve.png
[Plotter] Metrics curve saved to: D:\AI\test\CDSP-MoE\analysis\pic\cdsp_mnist_3task\metrics_curve.png
Results saved to: D:\AI\test\CDSP-MoE\analysis\pic\cdsp_mnist_3task

进程已结束，退出代码为 0
